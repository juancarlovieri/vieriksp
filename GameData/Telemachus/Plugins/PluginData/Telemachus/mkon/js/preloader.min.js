(function(){"use strict";function t(t,e){var o=[],n=this.options;return n.onProgress&&t&&n.onProgress.call(this,t,e,this.completed.length),this.completed.length+this.errors.length===this.queue.length&&(o.push(this.completed),this.errors.length&&o.push(this.errors),n.onComplete.apply(this,o)),this}var e="addEventListener"in new Image,o=function(t,e){this.options={pipeline:!1,auto:!0,prefetch:!1,onComplete:function(){}},e&&"object"==typeof e&&this.setOptions(e),this.addQueue(t),this.queue.length&&this.options.auto&&this.processQueue()};o.prototype.setOptions=function(t){var e,o=this.options;for(e in t)t.hasOwnProperty(e)&&(o[e]=t[e]);return this},o.prototype.addQueue=function(t){return this.queue=t.slice(),this},o.prototype.reset=function(){return this.completed=[],this.errors=[],this},o.prototype.addEvents=function(o,n,r){var s=this,i=this.options,h=function(){e?(this.removeEventListener("error",l),this.removeEventListener("abort",l),this.removeEventListener("load",u)):this.onerror=this.onabort=this.onload=null},l=function(){console.log("src error:"+n),h.call(this),s.errors.push(n),i.onError&&i.onError.call(s,n),t.call(s,n),i.pipeline&&s.loadNext(r)},u=function(){console.log("src load:"+n),h.call(this),s.completed.push(n),t.call(s,n,this),i.pipeline&&s.loadNext(r)};e?(o.addEventListener("error",l,!1),o.addEventListener("abort",l,!1),o.addEventListener("load",u,!1)):(o.onerror=o.onabort=l,o.onload=u)},o.prototype.load=function(t,e){var o=new Image;return this.addEvents(o,t,e),o.src=t,this},o.prototype.loadNext=function(t){return t++,this.queue[t]&&this.load(this.queue[t],t),this},o.prototype.processQueue=function(){var t=0,e=this.queue,o=e.length;if(this.reset(),this.options.pipeline)this.load(e[0],0);else for(;o>t;++t)this.load(e[t],t);return this},"function"==typeof define&&define.amd?define(function(){return o}):this.preLoader=o}).call(this);